HIGH-THROUGHPUT JOB SCHEDULER - ARCHITECTURE DIAGRAM
====================================================

┌─────────────────────────────────────────────────────────────────┐
│                         CLIENT LAYER                             │
│                    (HTTP REST API Clients)                        │
│  - Web Applications                                              │
│  - CLI Tools                                                     │
│  - Monitoring Systems                                            │
└──────────────────────────────┬──────────────────────────────────┘
                                │
                                │ HTTP REST API
                                │
┌───────────────────────────────▼──────────────────────────────────┐
│                      API LAYER (Express.js)                       │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │  REST Endpoints                                            │  │
│  │  ┌──────────────────┐  ┌──────────────────┐              │  │
│  │  │ POST /api/jobs   │  │ PUT /api/jobs/:id│              │  │
│  │  └──────────────────┘  └──────────────────┘              │  │
│  │  ┌──────────────────┐  ┌──────────────────┐              │  │
│  │  │ GET /api/jobs/:id│  │ GET /api/metrics │              │  │
│  │  └──────────────────┘  └──────────────────┘              │  │
│  │  ┌──────────────────┐  ┌──────────────────┐              │  │
│  │  │ GET /executions  │  │ GET /api/health  │              │  │
│  │  └──────────────────┘  └──────────────────┘              │  │
│  └────────────────────────────────────────────────────────────┘  │
│  Request Validation │ Error Handling │ JSON Serialization        │
└───────────────────────────────┬──────────────────────────────────┘
                                │
                                │
┌───────────────────────────────▼──────────────────────────────────┐
│                      SERVICE LAYER                                │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │                    JobScheduler                            │  │
│  │  ┌──────────────────────────────────────────────────────┐  │  │
│  │  │ • CRON Expression Parser (with seconds)            │  │  │
│  │  │ • Schedule Management (in-memory)                   │  │  │
│  │  │ • Job Matching (every second)                       │  │  │
│  │  │ • Drift Calculation & Minimization                  │  │  │
│  │  │ • Metrics Collection                                │  │  │
│  │  └──────────────────────────────────────────────────────┘  │  │
│  └────────────────────────────────────────────────────────────┘  │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │                    JobExecutor                            │  │
│  │  ┌──────────────────────────────────────────────────────┐  │  │
│  │  │ • HTTP POST Execution                                │  │  │
│  │  │ • At-Least-Once Semantics                            │  │  │
│  │  │ • Retry Logic (exponential backoff)                  │  │  │
│  │  │ • Concurrent Execution Management                    │  │  │
│  │  │ • Timeout Handling                                   │  │  │
│  │  └──────────────────────────────────────────────────────┘  │  │
│  └────────────────────────────────────────────────────────────┘  │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │                    AlertService                           │  │
│  │  ┌──────────────────────────────────────────────────────┐  │  │
│  │  │ • Failure Detection                                  │  │  │
│  │  │ • Webhook Notifications                              │  │  │
│  │  │ • Alert Logging                                      │  │  │
│  │  └──────────────────────────────────────────────────────┘  │  │
│  └────────────────────────────────────────────────────────────┘  │
└───────────────────────────────┬──────────────────────────────────┘
                                │
                                │ Database Operations
                                │
┌───────────────────────────────▼──────────────────────────────────┐
│                      DATA LAYER                                   │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │                  SQLite Database                          │  │
│  │                                                            │  │
│  │  ┌──────────────────────┐  ┌──────────────────────────┐   │  │
│  │  │    jobs table       │  │ job_executions table     │   │  │
│  │  │                      │  │                          │   │  │
│  │  │ • id (PK)            │  │ • id (PK)                │   │  │
│  │  │ • schedule           │  │ • job_id (FK)            │   │  │
│  │  │ • api                │  │ • scheduled_time        │   │  │
│  │  │ • type               │  │ • executed_time         │   │  │
│  │  │ • created_at         │  │ • status                │   │  │
│  │  │ • updated_at         │  │ • http_status           │   │  │
│  │  │ • active             │  │ • duration              │   │  │
│  │  └──────────────────────┘  │ • error_message         │   │  │
│  │                            │ • retry_count           │   │  │
│  │                            └──────────────────────────┘   │  │
│  │                                                            │  │
│  │  Indexes:                                                  │  │
│  │  • idx_job_executions_job_id                              │  │
│  │  • idx_job_executions_scheduled_time                      │  │
│  │  • idx_jobs_active                                         │  │
│  └────────────────────────────────────────────────────────────┘  │
└───────────────────────────────────────────────────────────────────┘
                                │
                                │ HTTP POST Requests
                                │
┌───────────────────────────────▼──────────────────────────────────┐
│              EXTERNAL APIs (Job Execution Targets)                │
│  ┌──────────────────┐  ┌──────────────────┐                    │
│  │  API Endpoint 1  │  │  API Endpoint 2  │  ...               │
│  └──────────────────┘  └──────────────────┘                    │
└──────────────────────────────────────────────────────────────────┘


DATA FLOW DIAGRAM
=================

Job Creation Flow:
──────────────────
Client → POST /api/jobs
    ↓
API Layer (Validation)
    ↓
JobScheduler.addJob()
    ↓
Database.createJob()
    ↓
JobScheduler.scheduleJob() (in-memory)
    ↓
Response: jobId


Job Execution Flow:
───────────────────
Scheduler (every second)
    ↓
CronParser.matches() (check all jobs)
    ↓
For matching jobs:
    ├─ Generate executionId
    ├─ Database.createExecution() (PENDING)
    ├─ JobExecutor.executeJobAsync() (async)
    │   ├─ HTTP POST (with retries)
    │   ├─ Database.updateExecution() (SUCCESS/FAILED)
    │   └─ AlertService.sendAlert() (if failed)
    └─ Update nextExecution time


At-Least-Once Execution:
────────────────────────
Execute HTTP POST
    ↓
Success? ──Yes──→ Mark SUCCESS → Done
    │
    No
    ↓
Retry (up to N times)
    ↓
All retries failed?
    ├─ Yes → Mark FAILED → Send Alert
    └─ No → Retry with backoff


COMPONENT INTERACTIONS
======================

┌─────────────┐         ┌─────────────┐         ┌─────────────┐
│   Client    │────────▶│  API Layer  │────────▶│JobScheduler │
└─────────────┘         └─────────────┘         └──────┬──────┘
                                                        │
                                                        │
                        ┌──────────────────────────────┼──────────────┐
                        │                              │              │
                        ▼                              ▼              ▼
                ┌──────────────┐              ┌──────────────┐  ┌──────────────┐
                │   Database   │              │JobExecutor   │  │AlertService  │
                └──────────────┘              └──────┬───────┘  └──────────────┘
                                                      │
                                                      │ HTTP POST
                                                      ▼
                                              ┌──────────────┐
                                              │ External API │
                                              └──────────────┘

